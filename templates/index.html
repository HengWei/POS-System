<!DOCTYPE html>
<html lang="en">
<head>
    {% load staticfiles %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Affogato Café POS System Demo Version</title>
    <link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet">
    <link href="{% static "css/navbar-static-top.css" %}" rel="stylesheet">
    <link href="{% static "css/jquery.dataTables.min.css" %}" rel="stylesheet">
    <link href="{% static "css/navbar.css" %}" rel="stylesheet">
    <link href="{% static "css/ie10-viewport-bug-workaround.css" %}" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.1.1/ekko-lightbox.css" rel="stylesheet">


    <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="http://cdn.datatables.net/1.10.1/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.1.1/ekko-lightbox.js"></script>


    <link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/1.10.1/css/jquery.dataTables.css">
    <link rel="stylesheet" type="text/css"
          href="http://cdn.datatables.net/responsive/1.0.0/css/dataTables.responsive.css">
    <script type="text/javascript"
            src="http://cdn.datatables.net/responsive/1.0.0/js/dataTables.responsive.js"></script>
    {#    <link href="{% static "js/jquery-1.11.3.min.js" %}" rel="stylesheet">#}
    {#    <link href="{% static "js/jquery.dataTables.min.js" %}" rel="stylesheet">#}

    {#    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.15/css/jquery.dataTables.css">#}

    {#    <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.15/js/jquery.dataTables.js"></script>#}


    {#    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>#}
    <link href="{% static "js/ie-emulation-modes-warning.js" %}" rel="stylesheet">


    <script>
        {#        var dataSet = {};#}
        var getData = [];
        $(document).ready(function () {

            dataSet = [];
            var columnDefs = [
                        {
                            title: "品項ID",
                            visible: false,

                        },
                        {
                            title: "品項"
                        }, {
                            title: "單價"
                        }, {
                            title: "數量"
                        }, {
                            title: "小計"
                        }, {
                            "defaultContent": '<button type="button" class="btn-tra glyphicon glyphicon-trash"></button >'
                        },
                    ]
                    ;

            var myTable;

            myTable = $('#example').DataTable({
                {#                "sPaginationType": "full_numbers",#}
                data: dataSet,
                columns: columnDefs,
                ordering: false,
                bFilter: false,
                bPaginate: false,
                {#                dom: 'Bfrtip',        // Needs button container#}
                {#                select: 'single',#}
                {#                responsive: true,#}
                {#                altEditor: true,     // Enable altEditor#}

                {#                    {#}
                {#                        extend: 'selected', // Bind to Selected row#}
                {#                        text: 'Edit',#}
                {#                        name: 'edit'        // do not change name#}
                {#                    },#}
                {#                    {#}
                {#                        extend: 'selected', // Bind to Selected row#}
                {#                        text: 'Delete',#}
                {#                        name: 'delete'      // do not change name#}
                {#                    }]#}
            });

            $('#example tbody').on('click', '.btn-tra', function (e) {
                getData = myTable.row($(this).parents('tr')).data();
                for (i = 0; i < dataSet.length; i++) {
                    if ((dataSet[i][0] == getData[0]) && (dataSet[i][3] == getData[3])) {
                        dataSet.splice(i, 1);
                        myTable.clear().rows.add(dataSet).draw();
                    }
                }
            });
        });
    </script>

    <script>
        var item = {};
        var firstFlag = 0;
        function ShowCount(id, Target, price, addition) {
            var speed = 'fast';
            HidenAllDiv();
            $('#mainMenu').hide(speed);
            if(addition==='')
            {
                $('#number').show(speed);
            }
            else
            {
                var additionItem=addition.split(',');
                $('#addition').show(speed);


            }
            item.id = id;
            item.name = Target;
            item.single = price;
        }
        ;

        function ShowMenu(Target) {
            var speed = 'fast';
            HidenAllDiv();
            $('#' + Target).show(speed);

            $('#txtNumber').val('1');
            firstFlag = 1;
        }
        ;

        function BackMenu(Target) {
            var speed = 'fast';
            HidenAllDiv();

            $('#mainMenu').show(speed);
            $('#number').hide(speed);
        }
        ;

        function HidenAllDiv() {
            var speed = 'fast';
            {% for foo in menuList %}
                $('#menu{{ foo.menuid }}').hide(speed);
            {% endfor %}
            $('#number').hide(speed);
            $('#mainMenu').hide(speed);
            $('#basicId').hide(speed);
            $('#basicNumber').hide(speed);
            $('#basicTime').hide(speed);

        }


        function Count(NumberVal, tagerDiv) {
            if ($('#number').is(':visible') || $('#basicId').is(':visible') || $('#basicTime').is(':visible') || $('#basicNumber').is(':visible')) {
                if (NumberVal == -1) {
                    $('#' + tagerDiv).val('');
                }
                else {
                    if (firstFlag) {
                        $('#' + tagerDiv).val(NumberVal.toString());
                        firstFlag = 0;
                    }
                    else {
                        $('#' + tagerDiv).val($('#' + tagerDiv).val() + NumberVal.toString());
                    }
                }
            }

            else {
                if (NumberVal == -1) {
                    $('#money').val('');
                    $('#change').val('');
                }
                else {
                    $('#money').val($('#money').val() + NumberVal.toString());
                }
            }
        }
        ;

        function CountTotal() {
            total = 0;
            for (i = 0; i < dataSet.length; i++) {
                total += dataSet[i][4]
            }
            $('#totalCount').val(total);
        }

        function PsuhToList() {
            item.num = $('#txtNumber').val();
            item.price = parseInt(item.num) * parseInt(item.single);
            var array = $.map(item, function (value, index) {
                return [value];
            });
            dataSet.push(array);
            item = {};
            $('#example').DataTable().clear().rows.add(dataSet).draw();
            $('#sellList').val(dataSet);
            BackMenu('number');
        }


        function Recive() {
            $('#change').val($('#money').val() - $('#totalCount').val());
        }

        function SetBasicInfo() {
            var speed = 'fast';
            HidenAllDiv();
            $('#mainMenu').show(speed);
            $('#labBasicId').text($('#txtBaiscId').val());
            $('#txtBasicInfoID').val($('#txtBaiscId').val());

            $('#labBasicNumber').text($('#txtBaiscNumber').val());
            $('#txtBasicInfoNumber').val($('#txtBaiscNumber').val());

            $('#labBasicTime').text($('#txtBaiscTime').val());
            $('#txtBasicInfoTime').val($('#txtBaiscTime').val());
        }


        ;


    </script>

</head>
<style>
    .btn {
        height: 110px;
        width: 23%;
        font-size: 16px;
        vertical-align: middle;
        font-family: 標楷體;
    }

    .menu {
        line-height: 120px;
        letter-spacing: 3px;
    }

    .btn-key {
        height: 80px;
        width: 85px;
        font-size: 30px;
        vertical-align: middle;
        font-family: 標楷體;
    }

    .keyboard {
        line-height: 100px;
        letter-spacing: 3px;
    }

    .form-control {
        font-size: 30px;
    }

    .table {
        font-size: 15px;
        font-family: 標楷體;
    }

    .container .jumbotron,
    .container-fluid .jumbotron {
        padding-right: 26px;
        padding-left: 26px;
    }

    .jumbotron {
        padding-top: 26px;
        padding-bottom: 26px;
    }

    .btn-tra {
        height: 30px;
        width: 35px;
    }
</style>
{#<script type="text/javascript" language="javascript"#}
{#        src="//cdn.datatables.net/responsive/1.0.0/js/dataTables.responsive.min.js"></script>#}

<body>
<div class="container">
    {% include 'navbar.html' %}
    <!-- Main component for a primary marketing message or call to action -->
    {#    <p>{{ r1.parentName }}</p>#}
    <div class="jumbotron col-lg-12 col-md-12" id="basicInfo">
        <p style="font-size: 16px">
            點單編號： <span id="labBasicId">{{ basicInfo.sellno }}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;進入時間：<span
                id="labBasicTime">{{ basicInfo.entrytime|date:'H:i' }}</span>&nbsp;&nbsp;&nbsp;&nbsp;人數：<span
                id="labBasicNumber">{{ basicInfo.customernumber }}</span>
        </p>
    </div>
    <div class="jumbotron col-lg-6 col-md-6">
        <div class="menu" id="mainMenu">
            {% for r1 in menuList %}
                <button class="btn btn-lg btn-primary"
                        onclick="javascript:ShowMenu('menu{{ r1.menuid }}');">
                    {% autoescape off %}{{ r1.menuname }}{% endautoescape %}</button>
            {% endfor %}

            <button class="btn btn-success" onclick="jvascript:ShowMenu('basicId')">顧客資訊</button>


            <a href="#myModal" data-toggle="modal">
                <button class="btn btn-warning" onclick="jvascript:CountTotal()">結帳</button>
            </a>
        </div>
        {% for t1 in menuList %}
            <div class="menu" id="menu{{ t1.menuid }}" hidden>
                {% for m2 in menu1 %}
                    {% if t1.menuid == m2.menuparentid %}
                        <button class="btn btn-lg btn-primary "
                                onclick="javascript:ShowCount({{ m2.menuid }},'{{ m2.menuname }}',{{ m2.menuprice }},'{{ m2.menuaddition }}');">
                            {% autoescape off %}{{ m2.menuname }}{% endautoescape %}</button>
                    {% endif %}
                {% endfor %}
                <button class="btn btn-lg btn-warning" onclick="javascript:BackMenu('menu{{ t1.menuid }}');">回上一頁
                </button>
            </div>
        {% endfor %}

        <div id="basicId" class="keyboard" style="display: none">
            <input type="text" class="form-control" id="txtBaiscId" style="height: 60px" placeholder="單號">
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(1,'txtBaiscId');">1</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(2,'txtBaiscId');">2</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(3,'txtBaiscId');">3</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(4,'txtBaiscId');">4</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(5,'txtBaiscId');">5</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(6,'txtBaiscId');">6</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(7,'txtBaiscId');">7</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(8,'txtBaiscId');">8</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(9,'txtBaiscId');">9</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(0,'txtBaiscId');">0</button>
            <button class="btn btn-lg btn-warning btn-key" onclick="javascript:Count(-1,'txtBaiscId');">更正</button>
            <button class="btn btn-lg btn-danger btn-key" onclick="javascript:BackMenu('menu-1','txtBaiscId');">取消
            </button>
            <button class="btn btn-lg btn-success btn-key" onclick="javascript:ShowMenu('basicTime');">時間</button>
            <br>
        </div>

        <div id="basicNumber" class="keyboard" style="display: none">
            <input type="text" class="form-control" id="txtBaiscNumber" style="height: 60px" placeholder="人數">
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(1,'txtBaiscNumber');">1</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(2,'txtBaiscNumber');">2</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(3,'txtBaiscNumber');">3</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(4,'txtBaiscNumber');">4</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(5,'txtBaiscNumber');">5</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(6,'txtBaiscNumber');">6</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(7,'txtBaiscNumber');">7</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(8,'txtBaiscNumber');">8</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(9,'txtBaiscNumber');">9</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(0,'txtBaiscNumber');">0</button>
            <button class="btn btn-lg btn-warning btn-key" onclick="javascript:Count(-1,'txtBaiscNumber');">更正</button>
            <button class="btn btn-lg btn-danger btn-key" onclick="javascript:BackMenu('menu-1','basicNumber');">取消
            </button>
            <button class="btn btn-lg btn-success btn-key" onclick="javascript: SetBasicInfo();">完成</button>
            <br>
        </div>


        <div id="basicTime" class="keyboard" style="display: none">
            <input type="text" class="form-control" id="txtBaiscTime" style="height: 60px" placeholder="時間：HHMM">
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(1,'txtBaiscTime');">1</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(2,'txtBaiscTime');">2</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(3,'txtBaiscTime');">3</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(4,'txtBaiscTime');">4</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(5,'txtBaiscTime');">5</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(6,'txtBaiscTime');">6</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(7,'txtBaiscTime');">7</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(8,'txtBaiscTime');">8</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(9,'txtBaiscTime');">9</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(0,'txtBaiscTime');">0</button>
            <button class="btn btn-lg btn-warning btn-key" onclick="javascript:Count(-1,'txtBaiscTime');">更正</button>
            <button class="btn btn-lg btn-danger btn-key" onclick="javascript:BackMenu('menu-1','basicTime');">取消
            </button>
            <button class="btn btn-lg btn-success btn-key" onclick="javascript:ShowMenu('basicNumber');">人數</button>
            <br>
        </div>

        <div id="number" class="keyboard" style="display: none">
            <input type="text" class="form-control" id="txtNumber" style="height: 60px" placeholder="數量">
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(1,'txtNumber');">1</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(2,'txtNumber');">2</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(3,'txtNumber');">3</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(4,'txtNumber');">4</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(5,'txtNumber');">5</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(6,'txtNumber');">6</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(7,'txtNumber');">7</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(8,'txtNumber');">8</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(9,'txtNumber');">9</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(0,'txtNumber');">0</button>
            <button class="btn btn-lg btn-warning btn-key" onclick="javascript:Count(-1,'txtNumber');">更正</button>
            <button class="btn btn-lg btn-danger btn-key" onclick="javascript:BackMenu('menu-1');">取消</button>
            <button class="btn btn-lg btn-success btn-key" onclick="javascript:PsuhToList();">小計</button>
            <br>
        </div>

        <div id="number" class="keyboard" style="display: none">
            <input type="text" class="form-control" id="txtNumber" style="height: 60px" placeholder="數量">
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(1,'txtNumber');">1</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(2,'txtNumber');">2</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(3,'txtNumber');">3</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(4,'txtNumber');">4</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(5,'txtNumber');">5</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(6,'txtNumber');">6</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(7,'txtNumber');">7</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(8,'txtNumber');">8</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(9,'txtNumber');">9</button>
            <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(0,'txtNumber');">0</button>
            <button class="btn btn-lg btn-warning btn-key" onclick="javascript:Count(-1,'txtNumber');">更正</button>
            <button class="btn btn-lg btn-danger btn-key" onclick="javascript:BackMenu('menu-1');">取消</button>
            <button class="btn btn-lg btn-success btn-key" onclick="javascript:PsuhToList();">小計</button>
            <br>
        </div>
        <div id="addition" class="menu" style="display: none">
            {% for addItem in menuAddition %}
                <button class="btn btn-lg btn-primary" onclick="javascript:Count(1,'txtNumber');">{% autoescape off %}{{ addItem.menuadditionname }}{% endautoescape %}</button>

            {% endfor %}




        </div>
    </div>
    <div class="col-lg-6 col-md-6">

        <table cellpadding="0" cellspacing="0" border="0" class="dataTable table table-striped" id="example"
               width="100%">
        </table>
    </div>
</div> <!-- /container -->


<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>

            </div>
            <div class="modal-body">
                <table class="table table-striped">
                    <tr>
                        <td>應付金額</td>
                        <td><input type="text" id="totalCount" readonly="readonly"></td>
                    </tr>
                    <tr>
                        <td>實付金額</td>
                        <td><input id="money" type="text" readonly="readonly"></td>
                    </tr>
                    <tr>
                        <td>找零</td>
                        <td><input type="text" id="change" readonly="readonly"></td>
                    </tr>
                    <tr>
                        <td colspan="2" class="keyboard">
                            <div class="keyboard">
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(1);">1</button>
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(2);">2</button>
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(3);">3</button>
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(4);">4</button>
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(5);">5</button>
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(6);">6</button>
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(7);">7</button>
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(8);">8</button>
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(9);">9</button>
                                <button class="btn btn-lg btn-primary btn-key" onclick="javascript:Count(0);">0</button>
                                <button class="btn btn-lg btn-warning btn-key" onclick="javascript:Count(-1);">清除
                                </button>
                                <button class="btn btn-danger btn-key" class="close" data-dismiss="modal">更正</button>
                                <button class="btn btn-success btn-key" onclick="Recive()">結帳</button>
                                <form action="/sell/" method="post">
                                    {% csrf_token %}
                                    <input type="text" id="sellList" name="sellList" hidden>
                                    <input type="text" id="txtBasicInfoID" name="txtBasicInfoID" hidden>
                                    <input type="text" id="txtBasicInfoTime" name="txtBasicInfoTime" hidden>
                                    <input type="text" id="txtBasicInfoNumber" name="txtBasicInfoNumber" hidden>
                                    <input type="text" id="txtBasicInfo" name="txtBasicInfo" hidden>
                                    <input type="text" id="txtSellBasicID" name="txtSellBasicID" hidden>
                                    <button class="btn btn-primary btn-key">完成</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
{#<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>#}
{#<script>window.jQuery || document.write('<script src={% static "js/jquery-3.2.0.min.js" %}><\/script>')</script>#}
<script src={% static "js/bootstrap.min.js" %}></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src={% static "js/ie10-viewport-bug-workaround.js" %}></script>
</body>
</html>